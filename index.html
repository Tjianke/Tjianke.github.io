<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="It&apos;s my personal blog.">
<meta property="og:type" content="website">
<meta property="og:title" content="My personal website">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="My personal website">
<meta property="og:description" content="It&apos;s my personal blog.">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="My personal website">
<meta name="twitter:description" content="It&apos;s my personal blog.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>My personal website</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">My personal website</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/10/Flask-tutorial/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tjianke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My personal website">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/10/Flask-tutorial/" itemprop="url">Flask_tutorial</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-10T22:40:34+08:00">
                2019-01-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Flask-Mega-Tutorial"><a href="#Flask-Mega-Tutorial" class="headerlink" title="Flask Mega-Tutorial"></a>Flask Mega-Tutorial</h1><h2 id="Part-I-Hello-world"><a href="#Part-I-Hello-world" class="headerlink" title="Part I: Hello world!"></a>Part I: Hello world!</h2><p>In this first chapter, we are going to learn how to set up a Flask project. By the end of this chapter you are going to have a simple Flask web application running on your computer!</p>
<p>I assume Python, Pip and Flask are already installed on your laptop.</p>
<p>Another helpful fact: if you want to set up isolated virtual environment for your project, use Venv.</p>
<p>Small tips :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 -m venv Name</span><br><span class="line">source /venv/bin/activate <span class="comment">#to activate</span></span><br></pre></td></tr></table></figure>
<p>In Python, <code>-</code> parameter m for module</p>
<p>In Python, a sub-directory that contains a <em>init</em> file is considered a <em>package</em>. When importing a package, init executes and tells which to exposes to outside world.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__) <span class="comment">#instantialize with module name</span></span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> routes</span><br></pre></td></tr></table></figure>
<p>Flask need <em>name</em> to tell where to find all the associated files, working like a dir_path variable.</p>
<p>Peculiar things happen, we have two <em>app</em> instances. And routes package import took place at the end unusally to avoid circular reference. Inside routes modules, different URLS are defined and implemented. In Python, handlers for the application routes are written as functions called <em>view functions</em>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> app</span><br><span class="line"><span class="meta">@app.route('/') # decorators</span></span><br><span class="line"><span class="meta">@app.route('/index')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Hello world"</span></span><br></pre></td></tr></table></figure>
<p>Decorators register current function as callback for certain events. Here we get to see two <em>app</em> variables happening together. First one is for module, and the second for variable instance.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set FLASK_APP=microblog.py  <span class="comment"># environment variable</span></span><br></pre></td></tr></table></figure>
<h2 id="Part-II-Templates"><a href="#Part-II-Templates" class="headerlink" title="Part II: Templates"></a>Part II: Templates</h2><p>View function return a simple string, we can use the render template function to </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> app</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="meta">@app.route('/index')</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    user = &#123;<span class="string">'username'</span>: <span class="string">'TJK'</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'''</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Home Page - Microblog&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;Hello, '''</span> + user[<span class="string">'username'</span>] + <span class="string">'''!&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;'''</span></span><br></pre></td></tr></table></figure>
<p>A better solution for passing data inside the web page is Jinja. First we need to introduce the idea of templates.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir app/templates <span class="comment">#copy the web page to template file as 'index.html'</span></span><br></pre></td></tr></table></figure>
<p>Use render_template to render index.html and pass in parameter.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> app</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="meta">@app.route('/index')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    user = &#123;<span class="string">'username'</span>: <span class="string">'TJK'</span>&#125;</span><br><span class="line">    posts = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">'author'</span>: &#123;<span class="string">'username'</span>: <span class="string">'John'</span>&#125;,</span><br><span class="line">            <span class="string">'body'</span>: <span class="string">'Beautiful day in Portland!'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">'author'</span>: &#123;<span class="string">'username'</span>: <span class="string">'Susan'</span>&#125;,</span><br><span class="line">            <span class="string">'body'</span>: <span class="string">'The Avengers movie was so cool!'</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>, title=<span class="string">'Home'</span>, user=user, post = post) <span class="comment"># title, user as passing var</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Jinja-template-engine"><a href="#Jinja-template-engine" class="headerlink" title="Jinja template engine:"></a>Jinja template engine:</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        &#123;%  if title %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123; &#123; title &#125; &#125; - Microblog<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Welcome to Microblog<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        &#123;% for post in posts %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; &#123; post.author.username &#125; &#125; says: <span class="tag">&lt;<span class="name">b</span>&gt;</span>&#123; &#123; post.body &#125; &#125;<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Template-Inheritance"><a href="#Template-Inheritance" class="headerlink" title="Template Inheritance"></a>Template Inheritance</h3><p>Real scenario, most web pages have a navbar at top. Inheritance perfectly solves such issue when scaling quickly.</p>
<p>Jinja2 has a template inheritance feature that specifically addresses this problem. In essence, what you can do is move the parts of the page layout that are common to all templates to a base template, from which all other templates are derived.</p>
<p>So what I’m going to do now is define a base template called base.html that includes a simple navigation bar and also the title logic I implemented earlier. You need to write the following template in file app/templates/base.html:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">      `&#123;% <span class="keyword">if</span> title %&#125;`</span><br><span class="line">      &lt;title&gt;&#123; &#123; title &#125; &#125; - Microblog&lt;/title&gt;</span><br><span class="line">      `&#123;% <span class="keyword">else</span> %&#125;`</span><br><span class="line">      &lt;title&gt;Welcome to Microblog&lt;/title&gt;</span><br><span class="line">      `&#123;% endif %&#125;`</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;div&gt;Microblog: &lt;a href="/index"&gt;Home&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">        &lt;hr&gt;</span><br><span class="line">        `&#123;% block Name %&#125;``&#123;% endblock %&#125;`</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>block content for derived web pages to insert self-defined content.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">`&#123;% extends <span class="string">"base.html"</span> %&#125;` <span class="comment">#establishes inheritance link</span></span><br><span class="line"></span><br><span class="line">`&#123;% block Name %&#125;`</span><br><span class="line">    &lt;h1&gt;Hi, &#123; &#123; user.username &#125; &#125;!&lt;/h1&gt;</span><br><span class="line">    `&#123;% <span class="keyword">for</span> post <span class="keyword">in</span> posts %&#125;`</span><br><span class="line">    &lt;div&gt;&lt;p&gt;&#123; &#123; post.author.username &#125; &#125; says: &lt;b&gt;&#123; &#123; post.body &#125; &#125;&lt;/b&gt;&lt;/p&gt;&lt;/div&gt;</span><br><span class="line">    `&#123;% endfor %&#125;`</span><br><span class="line">`&#123;% endblock %&#125;`</span><br></pre></td></tr></table></figure>
<h2 id="Part-III-Web-Forms"><a href="#Part-III-Web-Forms" class="headerlink" title="Part III: Web Forms"></a>Part III: Web Forms</h2><p>Web forms are one of the most basic func in web applications. Forms will be used to allow users to submit blog posts, and also for logging in to the application.</p>
<h3 id="Intro-to-flask-WTF"><a href="#Intro-to-flask-WTF" class="headerlink" title="Intro to flask-WTF"></a>Intro to flask-WTF</h3><p>To handle the web forms in this application I’m going to use the Flask-WTF extension, which is a thin wrapper around the WTForms package that nicely integrates it with Flask. This is the first Flask extension that I’m presenting to you, but it is not going to be the last. Extensions are a very important part of the Flask ecosystem, as they provide solutions to problems that Flask is intentionally not opinionated about.</p>
<p>Seperation of concern:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app = Flask(_name_)</span><br><span class="line">app.config[<span class="string">'SECRET_KEY'</span>] = <span class="string">'you-will-never-guess'</span></span><br><span class="line"><span class="comment"># ... add more variables here as needed</span></span><br></pre></td></tr></table></figure></p>
<p>Style like this is not accepted. A format that I really like because it is very extensible, is to use a class to store configuration variables. To keep things nicely organized, I’m going to create the configuration class in a separate Python module. Below you can see the new configuration class for this application, stored in a config.py module in the top-level directory.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span><span class="params">(object)</span>:</span></span><br><span class="line">    SECRET_KEY = os.environ.get(<span class="string">'SECRET_KEY'</span>) <span class="keyword">or</span> <span class="string">'you-will-never-guess'</span></span><br></pre></td></tr></table></figure></p>
<p>The SECRET_KEY configuration variable that I added as the only configuration item is an important part in most Flask applications. Flask and some of its extensions use the value of the secret key as a cryptographic key, useful to generate signatures or tokens. The Flask-WTF extension uses it to protect web forms against a nasty attack called Cross-Site Request Forgery or CSRF (pronounced “seasurf”). As its name implies, the secret key is supposed to be secret, as the strength of the tokens and signatures generated with it depends on no person outside of the trusted maintainers of the application knowing it.</p>
<p>The value of the secret key is set as an expression with two terms, joined by the or operator. The first term looks for the value of an environment variable, also called SECRET_KEY. The second term, is just a hardcoded string. This is a pattern that you will see me repeat often for configuration variables. The idea is that a value sourced from an environment variable is preferred, but if the environment does not define the variable, then the hardcoded string is used instead. When you are developing this application, the security requirements are low, so you can just ignore this setting and let the hardcoded string be used. But when this application is deployed on a production server, I will be setting a unique and difficult to guess value in the environment, so that the server has a secure key that nobody else knows.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> Config</span><br><span class="line"></span><br><span class="line">app = Flask(_name_)</span><br><span class="line">app.config.from_object(Config)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> routes</span><br></pre></td></tr></table></figure>
<p>The way I’m importing the Config class may seem confusing at first, but if you look at how the Flask class (uppercase “F”) is imported from the flask package (lowercase “f”) you’ll notice that I’m doing the same with the configuration. The lowercase “config” is the name of the Python module config.py, and obviously the one with the uppercase “C” is the actual class.</p>
<p>As I mentioned above, the configuration items can be accessed with a dictionary syntax from app.config. Here you can see a quick session with the Python interpreter where I check what is the value of the secret key:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="keyword">from</span> microblog <span class="keyword">import</span> app</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>app.config[<span class="string">'SECRET_KEY'</span>]</span><br><span class="line"><span class="string">'you-will-never-guess'</span></span><br></pre></td></tr></table></figure>
<h3 id="User-login-form"><a href="#User-login-form" class="headerlink" title="User-login form"></a>User-login form</h3><p>The Flask-WTF extension uses Python classes to represent web forms. A form class simply defines the fields of the form as class variables.</p>
<p>Once again having separation of concerns in mind, I’m going to use a new app/forms.py module to store my web form classes. To begin, let’s define a user login form, which asks the user to enter a username and a password. The form will also include a “remember me” check box, and a submit button:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask_wtf <span class="keyword">import</span> FlaskForm</span><br><span class="line"><span class="keyword">from</span> wtforms <span class="keyword">import</span> StringField, PasswordField, BooleanField, SubmitField</span><br><span class="line"><span class="keyword">from</span> wtforms.validators <span class="keyword">import</span> DataRequired</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginForm</span><span class="params">(FlaskForm)</span>:</span></span><br><span class="line">    username = StringField(<span class="string">'Username'</span>, validators=[DataRequired()])</span><br><span class="line">    password = PasswordField(<span class="string">'Password'</span>, validators=[DataRequired()])</span><br><span class="line">    remember_me = BooleanField(<span class="string">'Remember Me'</span>)</span><br><span class="line">    submit = SubmitField(<span class="string">'Sign In'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Form-Templates"><a href="#Form-Templates" class="headerlink" title="Form Templates"></a>Form Templates</h3><p>The next step is to add the form to an HTML template so that it can be rendered on a web page. The good news is that the fields that are defined in the LoginForm class know how to render themselves as HTML, so this task is fairly simple. Below you can see the login template, which I’m going to store in file app/templates/login.html:</p>
<p>app/templates/Login.html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">`&#123;% extends "base.html" %&#125;`</span><br><span class="line"></span><br><span class="line">`&#123;% block content %&#125;`</span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Sign In<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">        &#123; &#123; form.hidden_tag() &#125; &#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            &#123; &#123; form.username.label &#125; &#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            &#123; &#123; form.username(size=32) &#125; &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            &#123; &#123; form.password.label &#125; &#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            &#123; &#123; form.password(size=32) &#125; &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; &#123; form.remember_me() &#125; &#125; &#123; &#123; form.remember_me.label &#125; &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; &#123; form.submit() &#125; &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">`&#123;% endblock %&#125;`</span><br></pre></td></tr></table></figure></p>
<p>This template expects a form object instantiated from the LoginForm class to be given as an argument, which you can see referenced as form. This argument will be sent by the login view function, which I still haven’t written.</p>
<p>The HTML <form> element is used as a container for the web form. The action attribute of the form is used to tell the browser the URL that should be used when submitting the information the user entered in the form. When the action is set to an empty string the form is submitted to the URL that is currently in the address bar, which is the URL that rendered the form on the page. The method attribute specifies the HTTP request method that should be used when submitting the form to the server. The default is to send it with a GET request, but in almost all cases, using a POST request makes for a better user experience because requests of this type can submit the form data in the body of the request, while GET requests add the form fields to the URL, cluttering the browser address bar. The novalidate attribute is used to tell the web browser to not apply validation to the fields in this form, which effectively leaves this task to the Flask application running in the server. Using novalidate is entirely optional, but for this first form it is important that you set it because this will allow you to test server-side validation later in this chapter.</form></p>
<p>The form.hidden_tag() template argument generates a hidden field that includes a token that is used to protect the form against CSRF attacks. All you need to do to have the form protected is include this hidden field and have the SECRET_KEY variable defined in the Flask configuration. If you take care of these two things, Flask-WTF does the rest for you.</p>
<p>If you’ve written HTML web forms in the past, you may have found it odd that there are no HTML fields in this template. This is because the fields from the form object know how to render themselves as HTML. All I needed to do was to include { { form.&lt;field_name&gt;.label } } where I wanted the field label, and { { form.&lt;field_name&gt;() } } where I wanted the field. For fields that require additional HTML attributes, those can be passed as arguments. The username and password fields in this template take the size as an argument that will be added to the /input/ HTML element as an attribute. This is how you can also attach CSS classes or IDs to form fields.</p>
<h3 id="Form-views"><a href="#Form-views" class="headerlink" title="Form views"></a>Form views</h3><p>The final step before you can see this form in the browser is to code a new view function in the application that renders the template from the previous section.</p>
<p>So let’s write a new view function mapped to the /login URL that creates a form, and passes it to the template for rendering. This view function can also go in the app/routes.py module with the previous one:</p>
<p>routes.py:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> app</span><br><span class="line"><span class="keyword">from</span> app.forms <span class="keyword">import</span> LoginForm</span><br><span class="line"></span><br><span class="line"><span class="comment"># ...</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/login')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    form = LoginForm()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'login.html'</span>, title=<span class="string">'Sign In'</span>, form=form)</span><br></pre></td></tr></table></figure></p>
<h3 id="Receiving-Form-Data"><a href="#Receiving-Form-Data" class="headerlink" title="Receiving Form Data"></a>Receiving Form Data</h3><p>Still we need to validate for the submitted data first,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template, flash, redirect</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/login', methods = ['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    form = LoginForm()</span><br><span class="line">    <span class="keyword">if</span> form.validate_on_submit():</span><br><span class="line">        flash(<span class="string">'Login requested for user &#123;&#125;, remember_me=&#123;&#125;'</span>.format(</span><br><span class="line">            form.username.data, form.remember_me.data))</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">'/index'</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'login.html'</span>, title=<span class="string">'Sign In'</span>, form=form)</span><br></pre></td></tr></table></figure>
<p>Updated base.html for extending base:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        `&#123;% if title %&#125;`</span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123; &#123; title &#125; &#125; - microblog<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        `&#123;% else %&#125;`</span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>microblog<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        `&#123;% endif %&#125;`</span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            Microblog:</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/index"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/login"</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">        `&#123;% with messages = get_flashed_messages() %&#125;`</span><br><span class="line">        `&#123;% if messages %&#125;`</span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            `&#123;% for message in messages %&#125;`</span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; &#123; message &#125; &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            `&#123;% endfor %&#125;`</span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        `&#123;% endif %&#125;`</span><br><span class="line">        `&#123;% endwith %&#125;`</span><br><span class="line">        `&#123;% block content %&#125;``&#123;% endblock %&#125;`</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Improving-Field-Validation"><a href="#Improving-Field-Validation" class="headerlink" title="Improving Field Validation"></a>Improving Field Validation</h3><p>Providing error message by iterating form.data_field.errors<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">`&#123;% extends "base.html" %&#125;`</span><br><span class="line"></span><br><span class="line">`&#123;% block content %&#125;`</span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Sign In<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">        &#123; &#123; form.hidden_tag() &#125; &#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            &#123; &#123; form.username.label &#125; &#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            &#123; &#123; form.username(size=32) &#125; &#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            `&#123;% for error in form.username.errors %&#125;`</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"color: red;"</span>&gt;</span>[&#123; &#123; error &#125; &#125;]<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            `&#123;% endfor %&#125;`</span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            &#123; &#123; form.password.label &#125; &#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            &#123; &#123; form.password(size=32) &#125; &#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            `&#123;% for error in form.password.errors %&#125;`</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"color: red;"</span>&gt;</span>[&#123; &#123; error &#125; &#125;]<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            `&#123;% endfor %&#125;`</span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; &#123; form.remember_me() &#125; &#125; &#123; &#123; form.remember_me.label &#125; &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; &#123; form.submit() &#125; &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">`&#123;% endblock %&#125;`</span><br></pre></td></tr></table></figure></p>
<h3 id="Generating-Links"><a href="#Generating-Links" class="headerlink" title="Generating Links"></a>Generating Links</h3><p>Modulized thinking, use Flask func called url_for(), which generate url using its internal mapping of URLs to views function.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    Microblog:</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123; &#123; url_for('index') &#125; &#125;"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123; &#123; url_for('login') &#125; &#125;"</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Part-IV-Database"><a href="#Part-IV-Database" class="headerlink" title="Part IV: Database"></a>Part IV: Database</h2><p>Flask is known for its unopinoinated style. Therefore, it does not have any native databases. The databases can be separated into two big groups, those that follow the relational model, and those that do not. The latter group is often called NoSQL, indicating that they do not implement the popular relational query language SQL. While there are great database products in both groups, my opinion is that relational databases are a better match for applications that have structured data such as lists of users, blog posts, etc., while NoSQL databases tend to be better for data that has a less defined structure.</p>
<p>I’ll use Flask-SQLAlchemy, an extension that writes Flask friendly wrapper to popular SQLAlchemy package, which is an Object Relational Mapper. ORMs allow applications to manage a database using high-level entities such as classes, objects and methods instead of tables and SQL. The job of the ORM is to translate the high-level operations into database commands.</p>
<p>The nice thing about SQLAlchemy is that it is an ORM not for one, but for many relational databases. SQLAlchemy supports a long list of database engines, including the popular MySQL, PostgreSQL and SQLite. This is extremely powerful, because you can do your development using a simple SQLite database that does not require a server, and then when the time comes to deploy the application on a production server you can choose a more robust MySQL or PostgreSQL server, without having to change your application.</p>
<p>To install,<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(venv) pip install flask-sqlalchemy</span><br></pre></td></tr></table></figure></p>
<h3 id="Database-Migrations"><a href="#Database-Migrations" class="headerlink" title="Database Migrations"></a>Database Migrations</h3><p>Relational databases are centered around structured data, so when the structure changes the data that is already in the database needs to be migrated to the modified structure. The second extension that I’m going to present in this chapter is Flask-Migrate, which is actually one created by yours truly. This extension is a Flask wrapper for Alembic, a database migration framework for SQLAlchemy. Working with database migrations adds a bit of work to get a database started, but that is a small price to pay for a robust way to make changes to your database in the future.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(venv) $ pip install flask-migrate</span><br></pre></td></tr></table></figure>
<h3 id="Flask-SQLAlchemy-Configuration"><a href="#Flask-SQLAlchemy-Configuration" class="headerlink" title="Flask-SQLAlchemy Configuration"></a>Flask-SQLAlchemy Configuration</h3><p>During development, I’m going to use a SQLite database. SQLite databases are the most convenient choice for developing small applications as each database is stored in <strong>a single file</strong> on disk and there is no need to run a database server like MySQL and PostgreSQL.</p>
<p>We now need to configure our config.py to accomodate the two extensions.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">basedir = os.path.abspath(os.path.dirname(_file_))</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    SQLALCHEMY_DATABASE_URI = os.environ.get(<span class="string">'DATABASE_URL'</span>) <span class="keyword">or</span> \</span><br><span class="line">        <span class="string">'sqlite:#/'</span> + os.path.join(basedir, <span class="string">'app.db'</span>)</span><br><span class="line">    SQLALCHEMY_TRACK_MODIFICATIONS = <span class="keyword">False</span></span><br></pre></td></tr></table></figure></p>
<p>Now we need to add extensions inside the init.py file:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> Config</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">from</span> flask_migrate <span class="keyword">import</span> Migrate</span><br><span class="line"></span><br><span class="line">app = Flask(_name_)</span><br><span class="line">app.config.from_object(Config)</span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line">migrate = Migrate(app)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> routes, models <span class="comment"># models definde structure of a database</span></span><br></pre></td></tr></table></figure></p>
<p>I have made three changes to the init script. First, I have added a db object that represents the database. Then I have added another object that represents the migration engine. Hopefully you see a pattern in how to work with Flask extensions. Most extensions are initialized as these two. Finally, I’m importing a new module called models at the bottom. This module will define the structure of the database.</p>
<h3 id="Database-models"><a href="#Database-models" class="headerlink" title="Database models"></a>Database models</h3><p>The data that will be stored in the database will be represented by a collection of classes, usually called database models. The ORM layer within SQLAlchemy will do the translations required to map objects created from these classes into rows in the proper database tables.</p>
<p>Let’s start by creating a model that represents users. Using the <a href="http:#ondras.zarovi.cz/sql/demo" target="_blank" rel="noopener">WWW SQL Designer</a> tool, I have made the following diagram to represent the data that we want to use in the users table:</p>
<p>The id field is usually in all models, and is used as the primary key. Each user in the database will be assigned a unique id value, stored in this field. Primary keys are, in most cases, automatically assigned by the database, so I just need to provide the id field marked as a primary key.</p>
<p>The username, email and password_hash fields are defined as strings (or VARCHAR in database jargon), and their maximum lengths are specified so that the database can optimize space usage. While the username and email fields are self-explanatory, the password_hash fields deserves some attention. I want to make sure the application that I’m building adopts security best practices, and for that reason I will not be storing user passwords in the database. The problem with storing passwords is that if the database ever becomes compromised, the attackers will have access to the passwords, and that could be devastating for users. Instead of writing the passwords directly, I’m going to write <em>password hashes</em>, which greatly improve security. This is going to be the topic of another chapter, so don’t worry about it too much for now.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> db</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="keyword">True</span>)</span><br><span class="line">    username = db.Column(db.String(<span class="number">64</span>), index=<span class="keyword">True</span>, unique=<span class="keyword">True</span>)</span><br><span class="line">    email = db.Column(db.String(<span class="number">120</span>), index=<span class="keyword">True</span>, unique=<span class="keyword">True</span>)</span><br><span class="line">    password_hash = db.Column(db.String(<span class="number">128</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_repr_</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'&lt;User &#123;&#125;&gt;'</span>.format(self.username)</span><br></pre></td></tr></table></figure>
<p>User class above inherits from db.Model, a base class for all models from Flask- SQLAlchemy. This class defines several fields as class variables instantialized by db.Column methods, along with optional arguments that, for example, indicates which  fields are unique and indexed.</p>
<p>Tips: the <em>repr</em> method tells Python how to print objects of this class, which is going to be helpful for debugging.</p>
<h3 id="Creating-the-migration-repository"><a href="#Creating-the-migration-repository" class="headerlink" title="Creating the migration repository"></a>Creating the migration repository</h3><p>The model class created in the previous section initial database structure(or <strong>Schema</strong> as well). But it is common as the application continues to grow, there is a need to change the structure. Alembic helps to change the database without doing it from scratch.</p>
<p>To accomplish this seemingly difficult task, Alembic maintains a migration repository, which is a directory in which it stores its migration scripts.Each time a change is made to the database schema, a migration script is added to the repository with the details of the change. To apply the migrations to a database, these migration scripts are executed in the sequence they were created.</p>
<p>Create migration directory for microblog by running <strong>flask db init</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(venv) $ flask db init</span><br><span class="line">  Creating directory /home/miguel/microblog/migrations ... done</span><br><span class="line">  Creating directory /home/miguel/microblog/migrations/versions ... done</span><br><span class="line">  Generating /home/miguel/microblog/migrations/alembic.ini ... done</span><br><span class="line">  Generating /home/miguel/microblog/migrations/env.py ... done</span><br><span class="line">  Generating /home/miguel/microblog/migrations/README ... done</span><br><span class="line">  Generating /home/miguel/microblog/migrations/script.py.mako ... done</span><br><span class="line">  Please edit configuration/connection/logging settings <span class="keyword">in</span></span><br><span class="line">  <span class="string">'/home/miguel/microblog/migrations/alembic.ini'</span> before proceeding.</span><br></pre></td></tr></table></figure>
<p>Remember that the flask command relies on the FLASK_APP environment var to know where the Flask application lives.</p>
<h3 id="The-First-Database-Migration"><a href="#The-First-Database-Migration" class="headerlink" title="The First Database Migration"></a>The First Database Migration</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(venv) $ flask db migrate -m <span class="string">"users table"</span></span><br><span class="line">INFO  [alembic.runtime.migration] Context impl SQLiteImpl.</span><br><span class="line">INFO  [alembic.runtime.migration] Will assume non-transactional DDL.</span><br><span class="line">INFO  [alembic.autogenerate.compare] Detected added table <span class="string">'user'</span></span><br><span class="line">INFO  [alembic.autogenerate.compare] Detected added index <span class="string">'ix_user_email'</span> on <span class="string">'['</span>email<span class="string">']'</span></span><br><span class="line">INFO  [alembic.autogenerate.compare] Detected added index <span class="string">'ix_user_username'</span> on <span class="string">'['</span>username<span class="string">']'</span></span><br><span class="line">  Generating /home/miguel/microblog/migrations/versions/e517276bb1c2_users_table.py ... done</span><br></pre></td></tr></table></figure>
<p>Check the migration script if you want, they are actually made of two functions, upgrade and downgrade. The comment -m is optional to make some descriptive text. </p>
<p>flask db migrate only generates the script we need, to run it: flask db upgrade</p>
<p>When working with database servers such as MySQL and PostgreSQL, you have to create the database in the database server before running upgrade.</p>
<h3 id="Database-Upgrade-and-Downgrade-Workflow"><a href="#Database-Upgrade-and-Downgrade-Workflow" class="headerlink" title="Database Upgrade and Downgrade Workflow"></a>Database Upgrade and Downgrade Workflow</h3><p>Imagine that you have your Flask application set up both in working environment and development. Say you want to increase a new table in the working environ. Doing it manually might take a lot of work.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flask db migrate <span class="comment">#first to generate script</span></span><br><span class="line">flask db upgrade <span class="comment">#implement</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Database-Relationships"><a href="#Database-Relationships" class="headerlink" title="Database Relationships"></a>Database Relationships</h3><p>Relational database has been known as  good at storing relations. Consider the case of a user writing a blog post. The user will have a record in the users table, and the post will have a record in the posts table. The most efficient way to record who wrote a given post is to link the two related records.</p>
<p>Once a link between a user and a post is established, the database can answer queries about this link. The most trivial one is when you have a blog post and need to know what user wrote it. A more complex query is the reverse of this one. If you have a user, you may want to know all the posts that this user wrote. Flask-SQLAlchemy will help with both types of queries.</p>
<p>Let’s expand the database to store blog posts to see relationships in action. Here is the schema for a new posts table:<br><img src="https:#blog.miguelgrinberg.com/static/images/mega-tutorial/ch04-users-posts.png" alt="Database relationship"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> db</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="keyword">True</span>)</span><br><span class="line">    username = db.Column(db.String(<span class="number">64</span>), index=<span class="keyword">True</span>, unique=<span class="keyword">True</span>)</span><br><span class="line">    email = db.Column(db.String(<span class="number">120</span>), index=<span class="keyword">True</span>, unique=<span class="keyword">True</span>)</span><br><span class="line">    password_hash = db.Column(db.String(<span class="number">128</span>))</span><br><span class="line">    posts = db.relationship(<span class="string">'Post'</span>, backref=<span class="string">'author'</span>, lazy=<span class="string">'dynamic'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_repr_</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'&lt;User &#123;&#125;&gt;'</span>.format(self.username)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="keyword">True</span>)</span><br><span class="line">    body = db.Column(db.String(<span class="number">140</span>))</span><br><span class="line">    timestamp = db.Column(db.DateTime, index=<span class="keyword">True</span>, default=datetime.utcnow) <span class="comment"># assign as a func, better used for utc time </span></span><br><span class="line">    user_id = db.Column(db.Integer, db.ForeignKey(<span class="string">'user.id'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_repr_</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'&lt;Post &#123;&#125;&gt;'</span>.format(self.body)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/07/Vim-tutorial/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tjianke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My personal website">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/07/Vim-tutorial/" itemprop="url">Vim_tutorial</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-07T22:59:18+08:00">
                2019-01-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="The-Modes"><a href="#The-Modes" class="headerlink" title="The Modes"></a>The Modes</h1><h2 id="Insert-mode"><a href="#Insert-mode" class="headerlink" title="Insert mode"></a>Insert mode</h2><ol>
<li><p>hjkl for all around</p>
</li>
<li><p>0 moves the cursor to the beginning of the line.</p>
</li>
<li><p>$ moves the cursor to the end of the line.</p>
</li>
<li>w/b move forward/backword one word.</li>
<li>G/gg move to the end/beginning of the file.</li>
</ol>
<p>`. move to the last edit.</p>
<h2 id="Command-mode-Starting-mode"><a href="#Command-mode-Starting-mode" class="headerlink" title="Command mode (Starting mode)"></a>Command mode (Starting mode)</h2><h2 id="Last-line-mode-Esc"><a href="#Last-line-mode-Esc" class="headerlink" title="Last-line mode (Esc + :)"></a>Last-line mode (Esc + :)</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/12/Crawler/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tjianke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My personal website">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/12/Crawler/" itemprop="url">Crawler</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-12T16:21:16+08:00">
                2018-12-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1.Python open<br>rU 或 Ua 以读方式打开, 同时提供通用换行符支持 (PEP 278)<br>w     以写方式打开，<br>a     以追加模式打开 (从 EOF 开始, 必要时创建新文件)<br>r+     以读写模式打开<br>w+     以读写模式打开 (参见 w )<br>a+     以读写模式打开 (参见 a )<br>rb     以二进制读模式打开<br>wb     以二进制写模式打开 (参见 w )<br>ab     以二进制追加模式打开 (参见 a )<br>rb+    以二进制读写模式打开 (参见 r+ )<br>wb+    以二进制读写模式打开 (参见 w+ )<br>ab+    以二进制读写模式打开 (参见 a+ )</p>
<p>2.python directory supports backslash only</p>
<ol start="3">
<li>Thread, lock, first lock <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myThread</span> <span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, threadID, name, counter)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self.threadID = threadID</span><br><span class="line">        self.name = name</span><br><span class="line">        self.counter = counter</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"Starting "</span> + self.name)</span><br><span class="line">       <span class="comment"># 获得锁，成功获得锁定后返回True</span></span><br><span class="line">       <span class="comment"># 可选的timeout参数不填时将一直阻塞直到获得锁定</span></span><br><span class="line">       <span class="comment"># 否则超时后将返回False</span></span><br><span class="line">        threadLock.acquire() <span class="comment"># acquire lock  </span></span><br><span class="line">        print_time(self.name, self.counter, self.counter+<span class="number">4</span>)</span><br><span class="line">        <span class="comment"># 释放锁</span></span><br><span class="line">        threadLock.release() <span class="comment"># release lock</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_time</span><span class="params">(threadName, delay, counter)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> counter:</span><br><span class="line">        time.sleep(delay)</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"%s: %s"</span> % (threadName, time.ctime(time.time())))</span><br><span class="line">        counter -= <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">threadLock = threading.Lock()</span><br><span class="line">threads = []</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 创建新线程</span></span><br><span class="line">thread1 = myThread(<span class="number">1</span>, <span class="string">"Thread-1"</span>, <span class="number">1</span>)</span><br><span class="line">thread2 = myThread(<span class="number">2</span>, <span class="string">"Thread-2"</span>, <span class="number">2</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 开启新线程</span></span><br><span class="line">thread1.start()</span><br><span class="line">thread2.start()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 添加线程到线程列表</span></span><br><span class="line">threads.append(thread1)</span><br><span class="line">threads.append(thread2)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 等待所有线程完成</span></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">    t.join() <span class="comment"># wait until finishes</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">"Exiting Main Thread"</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>4.urlopen() return a binary file </p>
<p>In python, binary form : b’content’ needs to be decoded first</p>
<h1 id="Distributed"><a href="#Distributed" class="headerlink" title="Distributed"></a>Distributed</h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/06/Leetcode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tjianke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My personal website">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/06/Leetcode/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-06T21:03:52+08:00">
                2018-12-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<p>title: Leetcode date: 2018-10-29 21:11:00<br>tags: Algorithms—# Leetcode Conquest<br>This post mainly hosts all my code problems solved on Leetcode.</p>
<h2 id="Question-0-100"><a href="#Question-0-100" class="headerlink" title="Question 0-100"></a>Question 0-100</h2><h3 id="Q105-Construct-Binary-Tree-from-Preorder-and-Inorder-Traversal"><a href="#Q105-Construct-Binary-Tree-from-Preorder-and-Inorder-Traversal" class="headerlink" title="Q105 Construct Binary Tree from Preorder and Inorder Traversal"></a><strong>Q105 Construct Binary Tree from Preorder and Inorder Traversal</strong></h3><p>Description: Given preorder and inorder traversal of  a tree, try to construct the binary tree.</p>
<p>It might seem intimatidating at the first hand, but we can soon figure out following invariants:</p>
<ul>
<li>For inorder traversal, given certain elment, elements to its left are to its leftside. Same for right side.</li>
<li>For preorder traversal, root and root.left(if exist) are always contiguous.</li>
</ul>
<p>Exploiting previous invariants, we can define any mini trees(root and its subs) easily.</p>
<p>Process goes in this way:</p>
<p>1.Select root and split entire array into two parts(Left and Right)</p>
<p>2.Find root.lefe right after root in preorder array</p>
<p>3.Utilizing invariants, root.right is located by offseting root X (X = num of left side elements + 1) units.</p>
<p>4.Recursively repeat previous steps.</p>
<p>We can utilize the algo by introducing HashMap to store key-value of input array.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] preOrder;</span><br><span class="line">    <span class="keyword">int</span>[] inOrder;</span><br><span class="line">    HashMap map;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> TreeNode <span class="title">buildTree</span><span class="params">(<span class="keyword">int</span>[] preorder, <span class="keyword">int</span>[] inorder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.preOrder = preorder;</span><br><span class="line">        <span class="keyword">this</span>.inOrder = inorder;</span><br><span class="line">        HashMap&lt;Integer,Integer&gt; map2 = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;=preorder.length-<span class="number">1</span>; i++)&#123;</span><br><span class="line">            map2.put(inorder[i],i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.map = map2;</span><br><span class="line">        <span class="keyword">if</span>(preorder.length == <span class="number">0</span> || inorder.length==<span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        TreeNode root2 = <span class="keyword">new</span> TreeNode(preorder[<span class="number">0</span>]);</span><br><span class="line">        finder(root2,<span class="number">0</span>,<span class="number">0</span>,preorder.length-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> root2;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//find the treeNode</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">finder</span><span class="params">(TreeNode root, <span class="keyword">int</span> pos, <span class="keyword">int</span> begin, <span class="keyword">int</span> end)</span></span>&#123;<span class="comment">//pos : root index in preOrder</span></span><br><span class="line">        <span class="keyword">if</span>(begin&gt;=end) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> rootInOrder = (<span class="keyword">int</span>)(map.get(root.val));<span class="comment">//seperate InOrder list</span></span><br><span class="line">        <span class="keyword">if</span>(rootInOrder-<span class="number">1</span> &gt;= begin)&#123;</span><br><span class="line">            root.left = <span class="keyword">new</span> TreeNode(preOrder[pos+<span class="number">1</span>]);<span class="comment">// restrict pos+1&lt;=    </span></span><br><span class="line">            finder(root.left,pos+<span class="number">1</span>, begin, rootInOrder-<span class="number">1</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="comment">//if(rootInOrder &gt;= end) root.right = null;</span></span><br><span class="line">        <span class="keyword">if</span>(rootInOrder+<span class="number">1</span> &lt;= end)&#123;</span><br><span class="line">            <span class="keyword">int</span> rightIndex = pos+rootInOrder-begin+<span class="number">1</span>;</span><br><span class="line">            root.right = <span class="keyword">new</span> TreeNode(preOrder[rightIndex]);</span><br><span class="line">            finder(root.right,rightIndex, rootInOrder+<span class="number">1</span>, end);</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Parts to improve:</p>
<p>1.HashTable, HashMap and HashSet : put and get method</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HashMap&lt;Integer,Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">map.put(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">map.get(<span class="number">1</span>); <span class="comment">// returns an object</span></span><br></pre></td></tr></table></figure>
<p>2.Time complexity, review of master method :</p>
<p>check with this proof <a href="http://www.cs.cornell.edu/courses/cs3110/2012fa/recitations/mm-proof.pdf" target="_blank" rel="noopener">link</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/29/Java/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tjianke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My personal website">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/Java/" itemprop="url">Java</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-29T23:24:34+08:00">
                2018-11-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/29/API doc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tjianke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My personal website">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/API doc/" itemprop="url">API Doc</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-29T23:18:48+08:00">
                2018-11-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h3 id="1-查询指定单词词根"><a href="#1-查询指定单词词根" class="headerlink" title="1. 查询指定单词词根"></a>1. 查询指定单词词根</h3><h4 id="接口功能"><a href="#接口功能" class="headerlink" title="接口功能"></a>接口功能</h4><blockquote>
<p>给定单词，返回其所有词根</p>
</blockquote>
<h4 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h4><blockquote>
<p><a href="47.101.167.9:5050/search?word=Blahblah" target="_blank" rel="noopener">47.101.167.9:5050/search?word=Blahblah</a></p>
</blockquote>
<h4 id="支持格式"><a href="#支持格式" class="headerlink" title="支持格式"></a>支持格式</h4><blockquote>
<p>JSON</p>
</blockquote>
<h4 id="HTTP请求方式"><a href="#HTTP请求方式" class="headerlink" title="HTTP请求方式"></a>HTTP请求方式</h4><blockquote>
<p>GET</p>
</blockquote>
<h4 id="请求参数"><a href="#请求参数" class="headerlink" title="请求参数"></a>请求参数</h4><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">必选</th>
<th style="text-align:left">类型</th>
<th style="text-align:left">说明</th>
<th style="text-align:left">默认</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">word</td>
<td style="text-align:left">ture</td>
<td style="text-align:left">string</td>
<td style="text-align:left">查询的单词</td>
<td style="text-align:left">NA</td>
</tr>
<tr>
<td style="text-align:left">related_words</td>
<td style="text-align:left">false</td>
<td style="text-align:left">list</td>
<td style="text-align:left">关联单词，默认参数0，不返回</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">etym_meaning</td>
<td style="text-align:left">false</td>
<td style="text-align:left">list</td>
<td style="text-align:left">词根解释，默认参数0，不返回</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">word_meaning</td>
<td style="text-align:left">false</td>
<td style="text-align:left">string</td>
<td style="text-align:left">单词意思解释，默认参数0，不返回</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">word_pic</td>
<td style="text-align:left">false</td>
<td style="text-align:left">string</td>
<td style="text-align:left">单词图片，默认参数0，不返回</td>
<td style="text-align:left">0</td>
</tr>
</tbody>
</table>
<h4 id="返回字段"><a href="#返回字段" class="headerlink" title="返回字段"></a>返回字段</h4><table>
<thead>
<tr>
<th style="text-align:left">返回字段</th>
<th style="text-align:left">字段类型</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">status</td>
<td style="text-align:left">int</td>
<td style="text-align:left">返回结果状态。1：精准匹配；-1 ： 错误</td>
</tr>
<tr>
<td style="text-align:left">etym_breakdown</td>
<td style="text-align:left">list</td>
<td style="text-align:left">单词词根</td>
</tr>
<tr>
<td style="text-align:left">related_words</td>
<td style="text-align:left">list</td>
<td style="text-align:left">关联单词</td>
</tr>
<tr>
<td style="text-align:left">etym_meaning</td>
<td style="text-align:left">list of string</td>
<td style="text-align:left">解释(解释来源有2种，’Oxford’,’Etymology’均为词根的解释，可能存在缺失)</td>
</tr>
<tr>
<td style="text-align:left">word_meaning</td>
<td style="text-align:left">string</td>
<td style="text-align:left">单词意思解释</td>
</tr>
<tr>
<td style="text-align:left">word_pic</td>
<td style="text-align:left">string</td>
<td style="text-align:left">单词图片</td>
</tr>
</tbody>
</table>
<h4 id="接口示例"><a href="#接口示例" class="headerlink" title="接口示例"></a>接口示例</h4><blockquote>
<p>地址：<a href="47.101.167.9:5050/search?word=distribute" target="_blank" rel="noopener">47.101.167.9:5050/search?word=distribute</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;status&quot;: 1,</span><br><span class="line">    &quot;data&quot;:</span><br><span class="line">           &#123;&quot;etym_breakdown&quot;:</span><br><span class="line">                       [&#123;</span><br><span class="line">                        &quot;depth&quot;:1,</span><br><span class="line">                        &quot;etym&quot;:&quot;XXX&quot;,</span><br><span class="line">                        &quot;meaning&quot;:&quot;xxx&quot;,</span><br><span class="line">                        &quot;lang&quot;:&quot;Latin&quot;</span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;&apos;depth&apos;: 2,</span><br><span class="line">                        &apos;etym&apos;: &apos;distribut-&apos;,</span><br><span class="line">                        &apos;meaning&apos;: &apos;divided up&apos;,</span><br><span class="line">                        &apos;lang&apos;: &apos;Latin&apos;</span><br><span class="line">                        &#125;</span><br><span class="line">                        ...</span><br><span class="line">                        ]</span><br><span class="line">           &#125;,</span><br><span class="line">           &#123;&quot;related_words&quot;:</span><br><span class="line">                       [</span><br><span class="line">                            &#123;&quot;word&quot;:&quot;XXX&quot;&#125;，</span><br><span class="line">                            &#123;&quot;word&quot;:&quot;XXX&quot;&#125;，</span><br><span class="line">                            &#123;&quot;word&quot;:&quot;XXX&quot;&#125;，                       </span><br><span class="line">                       ]</span><br><span class="line">           </span><br><span class="line">           &#125;,</span><br><span class="line">           &#123;&quot;etym_meaning&quot;:</span><br><span class="line">                      &#123;&quot;Oxford_Dictionary&quot;:&quot;XXXX&quot;&#125;, </span><br><span class="line">                      &#123;&quot;Etymology_Online&quot;:&quot;XXXX&quot;&#125;,</span><br><span class="line">           &#125;,</span><br><span class="line">           &#123;&quot;word_meaning&quot;:&quot;XXXXXX&quot;&#125;,</span><br><span class="line">           &#123;&quot;word_pic&quot;:b&quot;0xFF AC 6C....&quot;&#125;,           </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="2-模糊查询指定单词"><a href="#2-模糊查询指定单词" class="headerlink" title="2. 模糊查询指定单词"></a>2. 模糊查询指定单词</h3><h4 id="接口功能-1"><a href="#接口功能-1" class="headerlink" title="接口功能"></a>接口功能</h4><blockquote>
<p>给定单词，返回其相关词根至多十个</p>
</blockquote>
<h4 id="URL-1"><a href="#URL-1" class="headerlink" title="URL"></a>URL</h4><blockquote>
<p><a href="47.101.167.9:5050/dictionary?word=Blahblah" target="_blank" rel="noopener">47.101.167.9:5050/dictionary?word=Blahblah</a></p>
</blockquote>
<h4 id="支持格式-1"><a href="#支持格式-1" class="headerlink" title="支持格式"></a>支持格式</h4><blockquote>
<p>JSON</p>
</blockquote>
<h4 id="HTTP请求方式-1"><a href="#HTTP请求方式-1" class="headerlink" title="HTTP请求方式"></a>HTTP请求方式</h4><blockquote>
<p>GET</p>
</blockquote>
<h4 id="请求参数-1"><a href="#请求参数-1" class="headerlink" title="请求参数"></a>请求参数</h4><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">必选</th>
<th style="text-align:left">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">word</td>
<td style="text-align:left">ture</td>
<td style="text-align:left">string</td>
<td>模糊查询的单词</td>
</tr>
</tbody>
</table>
<h4 id="返回字段-1"><a href="#返回字段-1" class="headerlink" title="返回字段"></a>返回字段</h4><table>
<thead>
<tr>
<th style="text-align:left">返回字段</th>
<th style="text-align:left">字段类型</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">status</td>
<td style="text-align:left">int</td>
<td style="text-align:left">返回结果状态。1：无准确结果；-1 ： 错误</td>
</tr>
<tr>
<td style="text-align:left">match</td>
<td style="text-align:left">list</td>
<td style="text-align:left">相似单词按照相关度排列</td>
</tr>
</tbody>
</table>
<h4 id="接口示例-1"><a href="#接口示例-1" class="headerlink" title="接口示例"></a>接口示例</h4><blockquote>
<p>地址：<a href="47.101.167.9:5050/dictionary?word=distribute" target="_blank" rel="noopener">47.101.167.9:5050/dictionary?word=distribute</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;status&quot;: 1,</span><br><span class="line">    &quot;data&quot;:</span><br><span class="line">           &#123;&quot;query&quot;:</span><br><span class="line">                       [&#123;&quot;match&quot;:&quot;XXX&quot;&#125;,</span><br><span class="line">                        &#123;&quot;match&quot;:&quot;XXX&quot;&#125;,</span><br><span class="line">                        ...</span><br><span class="line">                        ]</span><br><span class="line">           &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-查找指定单词发音相关文件"><a href="#3-查找指定单词发音相关文件" class="headerlink" title="3. 查找指定单词发音相关文件"></a>3. 查找指定单词发音相关文件</h3><h4 id="接口功能-2"><a href="#接口功能-2" class="headerlink" title="接口功能"></a>接口功能</h4><blockquote>
<p>给定单词，返回单词发音，例句发音</p>
</blockquote>
<h4 id="URL-2"><a href="#URL-2" class="headerlink" title="URL"></a>URL</h4><blockquote>
<p><a href="47.101.167.9:5050/audio?word=Blahblah" target="_blank" rel="noopener">47.101.167.9:5050/audio?word=Blahblah</a></p>
</blockquote>
<h4 id="支持格式-2"><a href="#支持格式-2" class="headerlink" title="支持格式"></a>支持格式</h4><blockquote>
<p>JSON</p>
</blockquote>
<h4 id="HTTP请求方式-2"><a href="#HTTP请求方式-2" class="headerlink" title="HTTP请求方式"></a>HTTP请求方式</h4><blockquote>
<p>GET</p>
</blockquote>
<h4 id="请求参数-2"><a href="#请求参数-2" class="headerlink" title="请求参数"></a>请求参数</h4><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">必选</th>
<th style="text-align:left">类型</th>
<th>说明</th>
<th>默认</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">word_pronunciation</td>
<td style="text-align:left">ture</td>
<td style="text-align:left">string</td>
<td>单词发音</td>
<td>1：返回单词发音 ，（0：不返回）</td>
</tr>
<tr>
<td style="text-align:left">sentence_pronunciation</td>
<td style="text-align:left">ture</td>
<td style="text-align:left">string</td>
<td>例句发音</td>
<td>1：返回例句发音， （0：不返回）</td>
</tr>
</tbody>
</table>
<h4 id="返回字段-2"><a href="#返回字段-2" class="headerlink" title="返回字段"></a>返回字段</h4><table>
<thead>
<tr>
<th style="text-align:left">返回字段</th>
<th style="text-align:left">字段类型</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">status</td>
<td style="text-align:left">int</td>
<td style="text-align:left">返回结果状态。1：精准匹配；-1 ： 错误</td>
</tr>
<tr>
<td style="text-align:left">word_pronunciation</td>
<td style="text-align:left">string</td>
<td style="text-align:left">单词发音</td>
</tr>
<tr>
<td style="text-align:left">sentence_pronunciation</td>
<td style="text-align:left">string</td>
<td style="text-align:left">例句发音</td>
</tr>
</tbody>
</table>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/29/Backend/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tjianke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My personal website">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/Backend/" itemprop="url">Backend</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-29T23:18:48+08:00">
                2018-11-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Backend sum up(NodeJS + Express + API + Database + RESTful)</p>
<p>MEAN VS LAMP</p>
<h3 id="NodeJS"><a href="#NodeJS" class="headerlink" title="NodeJS"></a>NodeJS</h3><h3 id="Express"><a href="#Express" class="headerlink" title="Express"></a>Express</h3><p>1.npm –init helps you set up your package.json file, which contains dependencies for ur app<br>2.npm <package> –save to add this package inside package.json</package></p>
<h3 id="Express-Routing-Assignment"><a href="#Express-Routing-Assignment" class="headerlink" title="Express Routing Assignment"></a>Express Routing Assignment</h3><ol>
<li>Create a brand new Express app from scratch</li>
<li>Create a package.json using <code>npm init</code> and add express as a dependency</li>
<li>In your main app.js file, add 3 different routes:</li>
</ol>
<h1 id="Visiting-“-“-should-print-“Hi-there-welcome-to-my-assignment-”"><a href="#Visiting-“-“-should-print-“Hi-there-welcome-to-my-assignment-”" class="headerlink" title="Visiting “/“ should print “Hi there, welcome to my assignment!”"></a>Visiting “/“ should print “Hi there, welcome to my assignment!”</h1><p>Visiting “/speak/pig” should print “The pig says ‘Oink’”<br>Visiting “/speak/cow” should print “The cow says ‘Moo’”</p>
<h1 id="Visiting-“-speak-dog”-should-print-“The-dog-says-‘Woof-Woof-’”"><a href="#Visiting-“-speak-dog”-should-print-“The-dog-says-‘Woof-Woof-’”" class="headerlink" title="Visiting “/speak/dog” should print “The dog says ‘Woof Woof!’”"></a>Visiting “/speak/dog” should print “The dog says ‘Woof Woof!’”</h1><p>Visiting “/repeat/hello/3” should print “hello hello hello”<br>Visiting “/repeat/hello/5” should print “hello hello hello hello hello”<br>Visiting “/repeat/blah/2”  should print “blah blah”</p>
<p>If a user visits any other route, print:<br>“Sorry, page not found…What are you doing with your life?”</p>
<p>through this process, we can sum that a basic server need to handle request and response.</p>
<p>Unexpected token : wrong one</p>
<p>Some takeway:<br>1.req.params</p>
<p>EJS usage :<br>1.footer/header partials embedding<br>2.Applying js inside an html file<br>3.Transmitting through diffirent files</p>
<p>Post request</p>
<h3 id="Basic-Mongo-command"><a href="#Basic-Mongo-command" class="headerlink" title="Basic Mongo command:"></a>Basic Mongo command:</h3><p>To start a database:<br>1../mongod<br>2.open up anothre terminal and mongod</p>
<p>DB demo for dog_app:<br>db.dogs.insert({name:”Rusty”,breed:”Mud”}) //db refers to current database using</p>
<p>show collections</p>
<p>db.dogs.find()</p>
<p>db.dogs.find({name:”Rusty”})</p>
<p>CRUD : create Read Update Destroy</p>
<p>db.dogs.update({name:”Lucy”},{breed:”Labradoodle”}) // overwrite all other data</p>
<p>db.dogs.update({name:”Lucy”},{$set:{breed:”Labradoodle”}})</p>
<p>db.dogs.remove({breed:”Labradoodle”})</p>
<p>db.dogs.remove({breed:”Labradoodle”}).limit(num of operation)</p>
<p>db.collection.drop()</p>
<p>RESTful routes</p>
<h1 id="name-URL-Type-Desc"><a href="#name-URL-Type-Desc" class="headerlink" title="name     URL              Type           Desc"></a>name     URL              Type           Desc</h1><p>INDEX    /dogs            GET            Display List<br>NEW      /dogs/new        GET            Display form to submit data<br>CREATE   /dogs            POST           Add data to DB</p>
<p>SHOW     /dogs/:id        GET            Shows info about one dog<br>EDIT     /dogs/:id/edit   GET            Sum NEW CREATE SHOW<br>UPDATE   /dogs/:id        PUT            Update info about dog</p>
<p>DESTROY  </p>
<p>RESTful routing</p>
<ul>
<li>Define REST and explain why it matters</li>
<li>List all 7 RESTful route</li>
<li>Several practice</li>
<li></li>
</ul>
<p>RESTful mapping between HTTP routes and CRUD</p>
<p>Specificity : </p>
<p>The following list of selector types increases by specificity:</p>
<p>1.Type selectors (e.g., h1) and pseudo-elements (e.g., ::before).<br>2.Class selectors (e.g., .example), attributes selectors (e.g., [type=”radio”]) and pseudo-classes (e.g., :hover).<br>3.ID selectors (e.g., #example).</p>
<p>input.value: for pre-filling</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/29/csapp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tjianke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My personal website">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/csapp/" itemprop="url">csapp</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-29T23:05:17+08:00">
                2018-11-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Short-intro-to-C"><a href="#Short-intro-to-C" class="headerlink" title="Short intro to C:"></a>Short intro to C:</h3><h4 id="Warm-up"><a href="#Warm-up" class="headerlink" title="Warm up"></a>Warm up</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt; studio.h&gt;                // C way of importing</span></span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">unsigned</span> <span class="title">sizeof</span><span class="params">(a)</span>             <span class="comment">//returns the num of byte</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span>     <span class="comment">// argc for num of param, argv is the array(0:function name)</span></span></span><br><span class="line">int* ptr_a, ptr_b;                  // bzzt! Fails</span><br></pre></td></tr></table></figure>
<p>The smallest unit in computer world is bit, two status (0 or 1)</p>
<p>8 bits = 1 byte </p>
<p>Hexadecimals begin with 0x</p>
<p>delimiter : \n \t</p>
<p><strong>Directives :</strong><br>|Symbol |Meaning      |   |<br>|——-|————-|—|<br>|d      |digital      |   |<br>|lu     |long unsiged |   |<br>|p      |pointer      |   |<br>|%c| char |single character.|<br>|%d| (%i) |int signed integer.|<br>|%e |(%E) |float or double exponential format.|<br>|%f |float| or double signed decimal.|<br>|%g |(%G) |float or double use %f or %e as required.|<br>|%o |int |unsigned octal value.|<br>|%p| pointer |address stored in pointer.|</p>
<p>8 C numeric type</p>
<table>
<thead>
<tr>
<th>C declaration</th>
<th>32-bit</th>
<th>64-bit</th>
<th>range</th>
</tr>
</thead>
<tbody>
<tr>
<td>char</td>
<td>1</td>
<td>1</td>
<td>2^8</td>
</tr>
<tr>
<td>short int</td>
<td>2</td>
<td>2</td>
<td>2^16</td>
</tr>
<tr>
<td>int</td>
<td>4</td>
<td>4</td>
<td>2^32</td>
</tr>
<tr>
<td>long int</td>
<td>4</td>
<td>8</td>
<td>2^64</td>
</tr>
<tr>
<td>long long int</td>
<td>8</td>
<td>8</td>
<td>2^64</td>
</tr>
<tr>
<td>char*(regardless of type)</td>
<td>4</td>
<td>8</td>
<td>2^64</td>
</tr>
<tr>
<td>float</td>
<td>4</td>
<td>8</td>
<td>2^64</td>
</tr>
<tr>
<td>double</td>
<td>8</td>
<td>8</td>
<td>2^64</td>
</tr>
</tbody>
</table>
<p>Big endian vs Small endian argurs the order in which bit arranged</p>
<p>Typedef helps to define certain type for brevity</p>
<h4 id="Noisy-pointer"><a href="#Noisy-pointer" class="headerlink" title="Noisy pointer"></a>Noisy pointer</h4><p><a href="https://boredzo.org/pointers/" target="_blank" rel="noopener">An article i highly recommend to read about pointer</a></p>
<p>Pointer points to the address of certain variable.</p>
<p><strong>Addition in pointer</strong> : </p>
<p><strong>Dereference </strong> : pointer with * on, assigns value</p>
<p><strong>Pointing </strong> : pointer without *, points and only accepts an adress</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> *array_ptr = <span class="built_in">array</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" first element: %i\n"</span>, *(array_ptr++));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"second element: %i\n"</span>, *(array_ptr++));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" third element: %i\n"</span>, *array_ptr);</span><br></pre></td></tr></table></figure>
<p>Hex to bin : XXXX - HH</p>
<h4 id="String-representation"><a href="#String-representation" class="headerlink" title="String representation"></a>String representation</h4><p>Each string in C is ended with 00s, and the most famous ones are ASCII character code.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show_bytes(<span class="string">"12345"</span>, <span class="number">6</span>);         <span class="comment">//output: 31 32 33 34 35 00(terminal)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *s = <span class="string">"abcdef"</span>;</span><br><span class="line">show_bytes((byte_pointer) s, <span class="built_in">strlen</span>(s));  <span class="comment">// output :61 62 63 64 65 66</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man ASCII // for ascii character code</span><br></pre></td></tr></table></figure>
<caption text-align="center"> Operations of Boolean algebra</caption>

<table>
<thead>
<tr>
<th>~</th>
<th>^</th>
<th>&amp;</th>
<th>slash</th>
</tr>
</thead>
<tbody>
<tr>
<td>NOT</td>
<td>XOR</td>
<td>AND</td>
<td>OR</td>
</tr>
</tbody>
</table>
<p>Fancy stuff here: swap two values without useing the third extra variable</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exchange</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123; <span class="comment">// a = 12 10010 b = 32 = 110010</span></span><br><span class="line">    a = a ^ b;                 <span class="comment">// a^b = 10000</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"The output is %d \n"</span>,a);</span><br><span class="line">    b = a ^ b;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"The output is %d \n"</span>,b);</span><br><span class="line">    a = a ^ b;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"The output is %d \n"</span>,a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Follow up:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse_array</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> cnt)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> first, last;</span><br><span class="line">    <span class="keyword">for</span> (first = <span class="number">0</span>, last = cnt<span class="number">-1</span>;</span><br><span class="line">    first &lt;= last;</span><br><span class="line">    first++,last--)</span><br><span class="line">    inplace_swap(&amp;a[first], &amp;a[last]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong> Masking operation </strong>: </p>
<h4 id="Shift-operation-in-C"><a href="#Shift-operation-in-C" class="headerlink" title="Shift operation in C:"></a>Shift operation in C:</h4><p>Logic : unsigned<br>Algorithmetic : signed one</p>
<p>Casting is actually based on bit level operation</p>
<p>explicit casting is possible as well:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">int</span> tx, ty;</span><br><span class="line"><span class="number">2</span> <span class="keyword">unsigned</span> ux, uy;</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span> tx = ux; <span class="comment">/* Cast to signed */</span></span><br><span class="line"><span class="number">5</span> uy = ty; <span class="comment">/* Cast to unsigned */</span></span><br></pre></td></tr></table></figure></p>
<p>Operand tend perform implicit casting to unsigned.</p>
<p>Extension</p>
<p>Truncating</p>
<p>Division in bit-level : first increment then right shift</p>
<p>A quick way to negate a number : 1.complement 2.increment</p>
<p>Common mistake with unsigned: sizeof() actually returns unsigned words</p>
<p>C retro time :</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span></span></span><br><span class="line"><span class="keyword">typedef</span></span><br></pre></td></tr></table></figure>
<p>word size: 32 bit / 64 bit</p>
<p>Floating point:</p>
<p>Discard the fractional binary representation.</p>
<p>IEEE 744 standard :</p>
<p>(-1)^s <em> 2^e </em> M<br>E = exp - bias</p>
<p>1.Denoramlized<br>2.Normalized</p>
<p>Default rounding : find the closest one</p>
<h1 id="Bit-Bytes-and-Integers"><a href="#Bit-Bytes-and-Integers" class="headerlink" title="Bit ,Bytes and Integers"></a>Bit ,Bytes and Integers</h1><ol>
<li>1 Byte = 8 bits = 2 hex digits</li>
<li>Common data type presentation</li>
<li>Boolean Algebra: And Or XOR Not</li>
<li>Contrast Logical ops (with Termination) (p&amp;&amp;*p avoids null pointer access)</li>
<li>shift ops,(logical &amp; algo)(Undefined for illegal shift)</li>
<li>#include&lt;limits.h&gt; : ULONG_MAX,LONG_MAX</li>
<li>Default:signed, Append U for Unsigned</li>
<li>If there be mix of U and S, S is casted implicitly to U</li>
<li>Little endian : refers to byte ordering </li>
</ol>
<h1 id="Floating-points"><a href="#Floating-points" class="headerlink" title="Floating points"></a>Floating points</h1><h2 id="1-Fractional-Binary-numbers"><a href="#1-Fractional-Binary-numbers" class="headerlink" title="1.Fractional Binary numbers:"></a>1.Fractional Binary numbers:</h2><p>limit: Only lists number that are very large or extremely samll</p>
<h2 id="2-IEEE-Floating-Point"><a href="#2-IEEE-Floating-Point" class="headerlink" title="2. IEEE Floating Point"></a>2. IEEE Floating Point</h2><p>1.Chem way of rounding, when exact half round to even, no bias theoretically<br>2.Bias = 2^(k - 1) - 1 , k is the exp bit<br>3.Single precison, sign : 1, E : 8, frac : 23<br>4.Noramalized Number<br>5.Denormalized<br>6.Special cases:  exp = 111…1, frac = 000..0 represents infinity(overflow<br>NaN exp = 111…11, frac != 000.000<br>7.FP multiplication, (-1)^(s1)<em> M1</em> 2^(E1)</p>
<pre><code>shift M to right, if more than 2, till overflow
</code></pre><p>8.Casting</p>
<pre><code>Float/double -&gt; int: truncate frac
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/29/15123 System programming in C & Unix/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tjianke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My personal website">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/15123 System programming in C & Unix/" itemprop="url">15123 System programming in C & Unix</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-29T23:05:17+08:00">
                2018-11-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Header Notation:<br>1.Chapter<br>2.In-chapter knowledge</p>
<h1 id="Lecture-1-Intro"><a href="#Lecture-1-Intro" class="headerlink" title="Lecture 1 Intro"></a>Lecture 1 Intro</h1><p>(Passed)</p>
<p>Some defs:</p>
<ol>
<li><p>Imperative programming, a programming paradigm that describes computation in terms of statments that change the state of the machine.</p>
</li>
<li><p>3 steps in developing C: Edit, Compile, Link</p>
</li>
<li><p>Must CLI argument, ANSI(define first), -pedantic -W -Wall</p>
</li>
</ol>
<h1 id="Lecture-2-Data-types-and-representations"><a href="#Lecture-2-Data-types-and-representations" class="headerlink" title="Lecture 2 Data types and representations"></a>Lecture 2 Data types and representations</h1><p>covered in 15213</p>
<h1 id="Lecture-3-Functions-Arrays-and-Strings"><a href="#Lecture-3-Functions-Arrays-and-Strings" class="headerlink" title="Lecture 3 Functions, Arrays and Strings"></a>Lecture 3 Functions, Arrays and Strings</h1><ul>
<li>Functions, input arguments, return values</li>
<li>Array fundamentals</li>
<li>String as char*’s</li>
<li>Command line arguments<h2 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h2></li>
</ul>
<p>1.Formatting statement “10.2f” means 10 spot in total and 2 decimal spot</p>
<p>2.Address is 32 bit, use <code>printf(&quot;%x&quot;, &amp;x)</code></p>
<p>3.C I/O open mode : “w”,”r”,”a(appebd)”,”b”</p>
<p>4.fscanf,fprintf,fopen:</p>
<pre><code>fprintf(fp, &quot;format %s&quot;, char *) 
scanf(&quot;%d&quot;, &amp;num) // pass in address
sscanf() // read word by word, kindof stupid
getchar() &lt;----&gt; putchar()
gets() &lt;-----&gt; puts()
fread() //for binary file
fscanf()
char * fgets(char *s, int size, FILE *stream)
</code></pre><h2 id="File-IO"><a href="#File-IO" class="headerlink" title="File IO"></a>File IO</h2><p>Any file is treated as a stream of bytes ended with EOF character. Yet distinction exists between text file and binary file.</p>
<p>EOF = -1 </p>
<figure class="highlight plain"><figcaption><span>(fscanf(fp,"%c", &ch) !</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## Arrays</span><br><span class="line">``` C</span><br><span class="line">char name[4]; //name serves as address in printf</span><br></pre></td></tr></table></figure>
<p>1.Unlike java, in C strings are made of char array and must end with /0;</p>
<h1 id="Lecture-4-Intro-to-pointer"><a href="#Lecture-4-Intro-to-pointer" class="headerlink" title="Lecture 4 Intro to pointer"></a>Lecture 4 Intro to pointer</h1><p>1.Defining : int <em> ptr, </em> could be anywhere</p>
<p>2.Dereferencing : assign an adress to pointer</p>
<p>3.Memory allocation in C:</p>
<ul>
<li>Unlike C++ and Java, no keyword “new”</li>
<li>use void* malloc(size_t size);</li>
<li></li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">int</span> *A = (*<span class="keyword">int</span>) <span class="built_in">malloc</span>(<span class="number">100</span>*<span class="keyword">sizeof</span>(<span class="keyword">int</span>)); <span class="comment">// assign A[100]</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// Traversal</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</span><br><span class="line">    A[i] = random();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Alternate</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</span><br><span class="line">    *(A+i) = random();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>Array of pointers</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span>* A[<span class="number">50</span>];</span><br><span class="line"><span class="keyword">for</span>(itn i = <span class="number">0</span> ; i&lt; <span class="number">50</span>; i++)&#123;</span><br><span class="line">    A[i] = <span class="literal">NULL</span>; <span class="comment">// initialize</span></span><br><span class="line">    A[i] = <span class="built_in">malloc</span>(length_of_string+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5.Functions that take pointers<br>A very good way to pass adresses(reference) instead of copy variables<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>* ptrA, <span class="keyword">int</span>* ptrB)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = *ptrA;</span><br><span class="line">    *ptrA = *ptrB;</span><br><span class="line">    *ptrB = temp;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> A =<span class="number">56</span>, B = <span class="number">40</span>;</span><br><span class="line">swap(&amp;A, &amp;B);</span><br></pre></td></tr></table></figure></p>
<p>It may as well be a bad idea to give direct access to actual data, so <figure class="highlight plain"><figcaption><span>int* ptr``` is better.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">6.Strings and pointers</span><br><span class="line">```C</span><br><span class="line">char* s = &quot;guna\0&quot;; // assign a string,</span><br></pre></td></tr></table></figure></p>
<p>problem arises, no extra room assigned for s, segement error when added    </p>
<ul>
<li>segfault happens when fscanf exceeds current limit;<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">fgets</span><span class="params">( <span class="keyword">char</span> *s, <span class="keyword">int</span> size, FILE *stream)</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>fgets uses at most size -1 </p>
<h1 id="Lecture-06-07-Debugging-problems-with-GDB-and-memory-leaks"><a href="#Lecture-06-07-Debugging-problems-with-GDB-and-memory-leaks" class="headerlink" title="Lecture 06-07 Debugging problems with GDB and memory leaks"></a>Lecture 06-07 Debugging problems with GDB and memory leaks</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gcc -ansi -Wall -pedantic main.c -o exec</span><br><span class="line">gcc -c -Wall -pedantic main.c </span><br><span class="line">gcc main.o -o exec</span><br></pre></td></tr></table></figure>
<p>1.Common mistakes using pointers:</p>
<ul>
<li>dereferenc of uninitialized pointers</li>
<li>insufficient allocated memorage</li>
<li>storage used after free</li>
<li>allocation freed repeatedly</li>
</ul>
<ol start="2">
<li><em>/<strong>/</strong></em> what’s the difference?</li>
</ol>
<h1 id="Lecture-08-Dynamic-Memory-Managment"><a href="#Lecture-08-Dynamic-Memory-Managment" class="headerlink" title="Lecture 08 Dynamic Memory Managment"></a>Lecture 08 Dynamic Memory Managment</h1><p>1.Inclued by &lt;stdlib.h&gt; (malloc free realloc calloc)</p>
<ul>
<li>void* malloc(size_t size) always remember to check <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span>* p;</span><br><span class="line"><span class="keyword">if</span>((p = <span class="built_in">malloc</span>(n)) == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;<span class="comment">// memory is allocated&#125;;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>2.frees any memo allocated by previous malloc call<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">free</span>(A);</span><br></pre></td></tr></table></figure></p>
<p>3.calloc(n,sizeof(int)) equals to malloc(n*sizeof(int))</p>
<p>4.realloc(void *ptr, size_t size)</p>
<p>5.Memory leaks, memory that has been allocated by an application, but not released later.</p>
<ul>
<li>Memory leak Example:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> A[n],i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line"> A[i] = random();</span><br><span class="line"><span class="keyword">int</span>* B = <span class="built_in">malloc</span>(<span class="number">2</span>*n);</span><br><span class="line">B = A; <span class="comment">//A=B, illegal</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>6.Automatic VS Dynamic variables</p>
<ul>
<li>int x, x is assigned by stack and pop when out of stack</li>
<li>int *A = malloc(100); provided in heap</li>
</ul>
<h1 id="lecture-09"><a href="#lecture-09" class="headerlink" title="lecture 09"></a>lecture 09</h1><h1 id="Supplement-Lecture-Socket"><a href="#Supplement-Lecture-Socket" class="headerlink" title="Supplement Lecture Socket"></a>Supplement Lecture Socket</h1><p>1.IP address, 32 bit address divided into 5 types</p>
<ul>
<li>In Unix, each I/O is related with file descriptors. An integer associated with an open file and it can be network connection etc</li>
</ul>
<p>2.Map IP to names, DNS</p>
<ul>
<li>The process of finding out dotted IP address based on the given alphanumeric host name is known as hostname resolution.</li>
<li>Correspondence of hosts and IP are kept in HOST(/etc/hosts)</li>
</ul>
<p>3.Client-server model<br>4.Architecture:</p>
<ul>
<li>2 tier web browser</li>
<li>3 tier middleware</li>
</ul>
<p>5.concurrent / iterative server<br><img src="https://www.tutorialspoint.com/unix_sockets/images/socket_client_server.gif" alt="TCP Client-Server"></p>
<p>Check this <a href="https://www.tutorialspoint.com/unix_sockets/socket_summary.htm" target="_blank" rel="noopener">website</a> for full info</p>
<p>Well, even more detailed by <a href="http://www.cs.rpi.edu/~moorthy/Courses/os98/Pgms/socket.html" target="_blank" rel="noopener">RPI</a></p>
<ul>
<li>Server.C </li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[] )</span> </span>&#123;</span><br><span class="line">   <span class="keyword">int</span> sockfd, newsockfd, portno, clilen;</span><br><span class="line">   <span class="keyword">char</span> buffer[<span class="number">256</span>];</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">serv_addr</span>, <span class="title">cli_addr</span>;</span></span><br><span class="line">   <span class="keyword">int</span>  n;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* First call to socket() function to establish a socket*/</span></span><br><span class="line">   sockfd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>); <span class="comment">//AF_INET for ipv4</span></span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span> (sockfd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      perror(<span class="string">"ERROR opening socket"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* Initialize socket structure */</span></span><br><span class="line">   bzero((<span class="keyword">char</span> *) &amp;serv_addr, <span class="keyword">sizeof</span>(serv_addr));</span><br><span class="line">   portno = <span class="number">5001</span>;</span><br><span class="line">   </span><br><span class="line">   serv_addr.sin_family = AF_INET;</span><br><span class="line">   serv_addr.sin_addr.s_addr = INADDR_ANY;</span><br><span class="line">   serv_addr.sin_port = htons(portno);</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* Now bind the host address using bind() call.*/</span></span><br><span class="line">   <span class="keyword">if</span> (bind(sockfd, (struct sockaddr *) &amp;serv_addr, <span class="keyword">sizeof</span>(serv_addr)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      perror(<span class="string">"ERROR on binding"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">      </span><br><span class="line">   <span class="comment">/* Now start listening for the clients, here process will</span></span><br><span class="line"><span class="comment">      * go in sleep mode and will wait for the incoming connection</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">   </span><br><span class="line">   listen(sockfd,<span class="number">5</span>);</span><br><span class="line">   clilen = <span class="keyword">sizeof</span>(cli_addr);</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* Accept actual connection from the client */</span></span><br><span class="line">   newsockfd = accept(sockfd, (struct sockaddr *)&amp;cli_addr, &amp;clilen);</span><br><span class="line">	</span><br><span class="line">   <span class="keyword">if</span> (newsockfd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      perror(<span class="string">"ERROR on accept"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* If connection is established then start communicating */</span></span><br><span class="line">   bzero(buffer,<span class="number">256</span>);</span><br><span class="line">   n = read( newsockfd,buffer,<span class="number">255</span> ); <span class="comment">//file descriptor</span></span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      perror(<span class="string">"ERROR reading from socket"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"Here is the message: %s\n"</span>,buffer);</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* Write a response to the client */</span></span><br><span class="line">   n = write(newsockfd,<span class="string">"I got your message"</span>,<span class="number">18</span>);</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      perror(<span class="string">"ERROR writing to socket"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">      </span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>client.c ./client localhost port_number</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">   <span class="keyword">int</span> sockfd, portno, n;</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">serv_addr</span>;</span></span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">hostent</span> *<span class="title">server</span>;</span></span><br><span class="line">   </span><br><span class="line">   <span class="keyword">char</span> buffer[<span class="number">256</span>];</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span> (argc &lt; <span class="number">3</span>) &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">"usage %s hostname port\n"</span>, argv[<span class="number">0</span>]);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">   &#125;</span><br><span class="line">	</span><br><span class="line">   portno = atoi(argv[<span class="number">2</span>]);</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* Create a socket point */</span></span><br><span class="line">   sockfd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span> (sockfd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      perror(<span class="string">"ERROR opening socket"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">	</span><br><span class="line">   server = gethostbyname(argv[<span class="number">1</span>]);<span class="comment">// returns hostent</span></span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span> (server == <span class="literal">NULL</span>) &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">"ERROR, no such host\n"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   bzero((<span class="keyword">char</span> *) &amp;serv_addr, <span class="keyword">sizeof</span>(serv_addr));</span><br><span class="line">   serv_addr.sin_family = AF_INET;</span><br><span class="line">   bcopy((<span class="keyword">char</span> *)server-&gt;h_addr, (<span class="keyword">char</span> *)&amp;serv_addr.sin_addr.s_addr, server-&gt;h_length);</span><br><span class="line">   serv_addr.sin_port = htons(portno);</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* Now connect to the server */</span></span><br><span class="line">   <span class="keyword">if</span> (connect(sockfd, (struct sockaddr*)&amp;serv_addr, <span class="keyword">sizeof</span>(serv_addr)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      perror(<span class="string">"ERROR connecting"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* Now ask for a message from the user, this message</span></span><br><span class="line"><span class="comment">      * will be read by server</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">	</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"Please enter the message: "</span>);</span><br><span class="line">   bzero(buffer,<span class="number">256</span>);</span><br><span class="line">   fgets(buffer,<span class="number">255</span>,<span class="built_in">stdin</span>);</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* Send message to the server */</span></span><br><span class="line">   n = write(sockfd, buffer, <span class="built_in">strlen</span>(buffer));</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      perror(<span class="string">"ERROR writing to socket"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/* Now read server response */</span></span><br><span class="line">   bzero(buffer,<span class="number">256</span>);</span><br><span class="line">   n = read(sockfd, buffer, <span class="number">255</span>);</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      perror(<span class="string">"ERROR reading from socket"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">	</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,buffer);</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/29/mysql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tjianke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My personal website">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/mysql/" itemprop="url">Mysql</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-29T21:11:00+08:00">
                2018-11-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Preface : some say installing Mysql trouble, luckily  it worked smoothly for me.</p>
<h1 id="Connect-Mysql-with-Python"><a href="#Connect-Mysql-with-Python" class="headerlink" title="Connect Mysql with Python"></a>Connect Mysql with Python</h1><p>1.Install Mysql Connector with : <code>pip install mysql-connector-python</code> // Question : What’s the difference between binary and source distribution</p>
<h1 id="Start-and-Shutdown-Mysql"><a href="#Start-and-Shutdown-Mysql" class="headerlink" title="Start and Shutdown Mysql"></a>Start and Shutdown Mysql</h1><p><strong>End query with ; !!</strong><br>1.To start, just enter <code>mysqld</code> </p>
<p>2.General logging method for mysql : <code>mysql -uroot -p</code></p>
<p>3.To shutdown, <code>mysqladmin -u root shutdown</code></p>
<h1 id="Querying-Mysql"><a href="#Querying-Mysql" class="headerlink" title="Querying Mysql"></a>Querying Mysql</h1><ul>
<li><code>select NAME|* from TABLE_NAME where CONDITIONAL;</code><ul>
<li>Notice keywords may be entered in any lettercase</li>
</ul>
</li>
</ul>
<h1 id="Creating-and-Using-a-Table"><a href="#Creating-and-Using-a-Table" class="headerlink" title="Creating and Using a Table"></a>Creating and Using a Table</h1><ul>
<li><code>show databases;</code>  to show all available DBs</li>
<li><code>use db</code> to switch to certain dbs;</li>
<li>Assume admin need to edit access for certain user <code>grant all on db.* to &#39;username@host&#39;</code> </li>
<li><p><strong>Create: </strong> <code>create table TABLE_NAME (var data_type)</code></p>
<ul>
<li>VARCHAR : defines length, 4 byte room</li>
<li>CHAR</li>
<li>DATE </li>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE pet (name VARCHAR(20), owner VARCHAR(20),</span><br><span class="line">    -&gt; species VARCHAR(20), sex CHAR(1), birth DATE, death DATE);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>describe</strong> show all detail of a table</p>
</li>
</ul>
<h1 id="Loading-Data-into-a-table"><a href="#Loading-Data-into-a-table" class="headerlink" title="Loading Data into a table"></a>Loading Data into a table</h1><ul>
<li>When you want to insert values into a table through txt file:<ul>
<li>Just enter data line by line and set null to <code>\N</code></li>
<li><code>load data local infile &#39;path/input.txt&#39; into table NAME</code></li>
</ul>
</li>
<li>Or in the normal way : <ul>
<li><code>insert into TABLE_NAME values(data data_type);</code></li>
</ul>
</li>
</ul>
<h1 id="Retrieving-Data-from-Tables"><a href="#Retrieving-Data-from-Tables" class="headerlink" title="Retrieving Data from Tables"></a>Retrieving Data from Tables</h1><ul>
<li><p>General retrieving pattern :</p>
<ul>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    SELECT what_to_select</span><br><span class="line">FROM which_table</span><br><span class="line">WHERE conditions_to_satisfy;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>Update : </strong> <code>update TABLE set tar_var = data where CONDITIONAL</code></p>
</li>
<li><strong>Select particular column</strong> :<ul>
<li><code>select column_name from TABLE</code></li>
</ul>
</li>
<li>To sort, use <code>Order</code> clause<ul>
<li>param: <code>DESC</code> to descending</li>
</ul>
</li>
</ul>
<h1 id="Pattern-Matching-in-Mysql"><a href="#Pattern-Matching-in-Mysql" class="headerlink" title="Pattern Matching in Mysql"></a>Pattern Matching in Mysql</h1><h1 id="Deleting-Databases-Tables"><a href="#Deleting-Databases-Tables" class="headerlink" title="Deleting Databases/Tables"></a>Deleting Databases/Tables</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">drop database DATABASE</span><br><span class="line">//For tables</span><br><span class="line">drop table TABLE</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Tjianke</p>
              <p class="site-description motion-element" itemprop="description">It's my personal blog.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tjianke</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
